<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <style>
    body {
      margin: 0;
      padding: 0;
      display: flex;
      height: 100vh;
      justify-content: center;
      align-items: center;
      background-color: #f0f0f0;
    }
    .game-window {
      width: 350px;
      background-color: #d9f1f2;
      display: flex;
      flex-direction: column;
      border-radius: 10px;
      box-shadow: 5px 5px 1px #5a6794;
      overflow: hidden;
    }

    .screen-frame {
      align-self: center;      
      margin: 25px 0;          
      border: 1px solid #555;  
      padding: 10px;           
      border-radius: 6px;      
      background-color: rgba(0,0,0,0.05); 
    }
    
    .content {
      background-color: #1c0e27;
      height: 110px;
      width: 165px;
      display: flex;
      /* 중요: CONNECTING 문구를 박스 정중앙에 배치 */
      justify-content: center;
      align-items: center;
      align-self: center;
      border-radius: 4px;
      box-shadow: 
        inset 3px 3px 6px rgba(0,0,0,0.5),
        inset -1px -1px 0 rgba(255,255,255,0.4); 
      /* 원리: 자식 요소(level-display)가 이 박스를 기준으로 위치를 잡게 함 */
      position: relative; 
    }

    .level-display {
      /* 원리: 부모(.content)의 왼쪽 상단(0,0)을 기준으로 좌표 설정 */
      position: absolute;
      top: 5px;            
      left: 8px;           
      color: #ffffff;      
      font-family: monospace;
      font-size: 12px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <div class="game-window">
    <div class="title-bar"></div>

    <div class="screen-frame">
      <div class="content" id="present-lv">
        <div class="level-display">LV. 01</div> 
        <div style="color: #00ff00; font-family: monospace;">CONNECTING...</div>
      </div>
    </div>
  </div>
  <script>
  // 설정: 나중에 노션에서 열 이름을 바꾸면 이 변수만 수정하세요.
  const LV_COLUMN_NAME = '현재 레벨'; 

  async function updateLevel() {
    const levelElement = document.querySelector('.level-display');
    
    try {
      // 1. 데이터베이스/페이지 정보 가져오기
      const response = await fetch('https://api.notion.com/v1/pages/${PAGE_ID}', {
        method: 'GET',
        headers: {
          'Authorization': 'Bearer ${NOTION_TOKEN}',
          'Notion-Version': '2022-06-28'
        }
      });
      const data = await response.json();

      // 2. 수식(formula) 결과값 추출 원리
      // 노션 수식은 결과 타입에 따라 string, number, boolean 등으로 나뉩니다.
      const formulaResult = data.properties[LV_COLUMN_NAME].formula;
      
      // 결과가 문자열이면 string, 숫자면 number를 가져옵니다. (있는 값을 그대로 선택)
      const currentLevel = formulaResult.string || formulaResult.number || formulaResult.date;

      // 3. 화면의 LV. 01 부분을 가져온 값으로 교체
      if (levelElement && currentLevel !== undefined) {
        levelElement.innerText = `${currentLevel}`;
      }

    } catch (error) {
      console.error("레벨 불러오기 실패:", error);
      levelElement.innerText = "LV. !!";
    }
  }

  // 페이지 로드 시 실행
  window.onload = updateLevel;
</script>

</body>
</html>